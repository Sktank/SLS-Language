<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>Forechat</title>
    {% block head %}
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css">
        <link rel="stylesheet" href="/main.css">
        <script type="text/javascript" src="/socket.io/socket.io.js"></script>
    {% endblock %}
    {% block js %}
    {% endblock %}
</head>
<body>
    <div class="container">
    {% block header %}
    <a href="/"><h1>SLS Language Chat</h1></a>
    {% endblock %}
    {% block content %}
    <div class="container">
        <div class="col-md-6">
            {% for index, language in languages %}
            {% if index < 4 %}
            <a id="start-{{language}}" class="btn btn-success btn-lg language-btn">{{ language }}</a>
            <div id="{{language}}dropdown"></div>
            {% endif %}
            {% endfor %}
        </div>
        <div class="col-md-6">
            {% for index, language in languages %}
            {% if index >= 4 %}
            <a id="start-{{language}}" class="btn btn-success btn-lg language-btn">{{ language }}</a>
            <div id="{{language}}dropdown"></div>
            {% endif %}
            {% endfor %}
        </div>
    </div>
    </div>

    <script>
        {% for index, language in languages %}
            var {{language}}toggle = false;
            var {{language}}disabled = false;
            var {{language}}checking = false;
            var {{language}}nativeIsChecked = false;
            console.log({{language}}toggle);
            $('#start-{{ language}}').on('click', function () {
                var self = this;
                console.log(self);
                if (!{{language}}disabled) {
                    {{language}}disabled = true;
                    if (!{{language}}toggle) {
                        $('#start-{{ language}}').append(
                                '<div class="skill-container">' +
                                '<a id="beginner-{{language}}" class="btn btn-info skill-btn" href="/chat/{{language}}/beginner/0">Beginner</a>' +
                                '<a id="intermediate-{{language}}" class="btn btn-warning btn-right-skill-level skill-btn" href="/chat/{{language}}/intermediate/0">Intermediate</a>' +
                                '<a id="advanced-{{language}}" class="btn btn-danger btn-right-skill-level skill-btn" href="/chat/{{language}}/advanced/0">Advanced</a>' +
                                '<a id="native-{{language}}" class="btn btn-right-skill-level btn-purp skill-btn" href="/chat/{{language}}/native/0">Native</a>' +
                                '</div>' +
                                '<form><div class="checkbox"><label class="languageCheckLabel" id="{{language}}checkboxlabel"><input type="checkbox" class="bigCheckbox" id="{{language}}checkbox">Also match me with native speakers</label></div></form>'

                        );

                        $('#{{language}}checkbox').click(function() {
                            console.log("checkbox");
                            {{language}}checking = true;
                            if ({{language}}nativeIsChecked == false) {
                                console.log('false');
                                $('#beginner-{{language}}').attr('href', $('#beginner-{{language}}').attr('href').substring(0, $('#beginner-{{language}}').attr('href').length - 2) + '/1');
                                $('#intermediate-{{language}}').attr('href', $('#intermediate-{{language}}').attr('href').substring(0, $('#intermediate-{{language}}').attr('href').length - 2) + '/1');
                                $('#advanced-{{language}}').attr('href', $('#advanced-{{language}}').attr('href').substring(0, $('#advanced-{{language}}').attr('href').length - 2) + '/1');
                                {{language}}nativeIsChecked = true;
                            }
                            else {
                                $('#beginner-{{language}}').attr('href', $('#beginner-{{language}}').attr('href').substring(0, $('#beginner-{{language}}').attr('href').length - 2) + '/0');
                                $('#intermediate-{{language}}').attr('href', $('#intermediate-{{language}}').attr('href').substring(0, $('#intermediate-{{language}}').attr('href').length - 2) + '/0');
                                $('#advanced-{{language}}').attr('href', $('#advanced-{{language}}').attr('href').substring(0, $('#advanced-{{language}}').attr('href').length - 2) + '/0');
                                {{language}}nativeIsChecked = false;
                            }
                        });

                        $('#{{language}}checkboxlabel').click(function() {
                            console.log("checkbox");
                            {{language}}checking = true;
                            if ({{language}}nativeIsChecked == false) {
                            console.log('false');
                            $('#beginner-{{language}}').attr('href', $('#beginner-{{language}}').attr('href').substring(0, $('#beginner-{{language}}').attr('href').length - 2) + '/1');
                            $('#intermediate-{{language}}').attr('href', $('#intermediate-{{language}}').attr('href').substring(0, $('#intermediate-{{language}}').attr('href').length - 2) + '/1');
                            $('#advanced-{{language}}').attr('href', $('#advanced-{{language}}').attr('href').substring(0, $('#advanced-{{language}}').attr('href').length - 2) + '/1');
                            {{language}}nativeIsChecked = true;
                        }
                        else {
                            $('#beginner-{{language}}').attr('href', $('#beginner-{{language}}').attr('href').substring(0, $('#beginner-{{language}}').attr('href').length - 2) + '/0');
                            $('#intermediate-{{language}}').attr('href', $('#intermediate-{{language}}').attr('href').substring(0, $('#intermediate-{{language}}').attr('href').length - 2) + '/0');
                            $('#advanced-{{language}}').attr('href', $('#advanced-{{language}}').attr('href').substring(0, $('#advanced-{{language}}').attr('href').length - 2) + '/0');
                            {{language}}nativeIsChecked = false;
                        }
                        });

                        {{language}}toggle = true;
                    }
                    else {
//                        setTimeout(function() {
                            if (!{{language}}checking) {
                            $('#start-{{ language}}').empty().append('{{language}}');
                            {{language}}toggle = false;
                            }
//                        }, 10)

                    }
                    {{language}}disabled = false;
                    {{language}}checking = false;
                };
            });




        {% endfor %}
    </script>


</body>
</html>
